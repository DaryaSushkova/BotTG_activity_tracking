# ДЗ-2 продвинутый python ИИ24
Сушкова Дарья Сергеевна

### Структура проекта
1. Директория `\bot` содержит кодовую базу реализации бота и включает следующие `.py` файлы:
    - `config.py`: инициализация ключей и настройка логирования бота;
    - `handlers.py`: реализация роутера и обработчиков бота;
    - `states.py`: инициализация объектов FSM;
    - `utils.py`: вспомогательные функции взаимодействия с API, расчета норм и построения графиков;
    - `bot.py`: точка входа в приложение, запускающая бот с подключенным роутером.

2. Директория `\optionals` включает дополнительные файлы - скриншоты для демонстрации работы. 

### Уточнения ТЗ
1. В профиль пользователя добавлены следующие характеристики:
- пол человека,
- тип активности (доступные значения: бег, йога, плавание, силовая);

    Данные атрибуты дополнительно участвуют в расчете дневной нормы калорий по уравнению Харриса-Бенедикта, а тип тренировок также влияет на формулу расчета сожженных калорий.<br>

2. Команда `/log_food` сразу запрашивает все параметры (продукт + граммовка), без разбиения на несколько пользовательских вводов. Формат: `/log_food <product_name>, <product_weight>`. Пользователь может не указывать граммовку, тогда вес будет по умолчанию равен $100$ г.<br>

3. Расчет температуры происходит при каждой инициализации профиля, а также с наступлением нового дня (при вызове команды `/new_day`).<br>

4. Расчет нормы калорий происходит только при каждой инициализации профиля.<br>

5. Пользователь может менять данные профиля, повторно вызвав команду `/set_profile`.

6. В боте предусмотрено четыре типа активностей: бег, йога, плавание, силовая. Очевидно, что в реальной жизни таковых намного больше, в рамках задания было решено формализовать список.

7. Если пользователь вводит некорректный город при заполнении профиля (некорректный - невозможно получить температуру через внешнее API), система устанавливает дефолтное значение как `Москва`.

### Дополнительные команды
1. `new_day` - команда предназначена для отсчета нового дня трекинга, то есть обнуляется количество потребленной воды и калорий, сожженных калорий. Команда также выводит результаты по воде и балансу калорий за предыдщий период трекинга.<br>
2. `profile_info` - команда просмотра информации из профиля пользователя, внесенной в предыдущий вызов команды `/set_profile`.

### Внешние API
1. Для получения текущей температуры для города используется сервис OpenWeatherMap API. Значение возвращается в градусах Цельсия, город можно передавать как на русском, так и на английском языках;
2. Для получения калорийности продуктов используется сервис Open Food Facts. Помимо наименования продукта возможно передавать его граммовку. Берется первый в выдаче продукт из списка, который заполняется прочими пользователями, поэтому значение калорийности иногда оказывается ошибочным / нулевым.

### Формулы расчетов
В рамках задания использовался следующий мэппинг типов активностей и количества ккал/мин:
```python
ACTIVITY_CALORIES = {
    "бег": 10,     
    "плавание": 8,  
    "силовая": 6,   
    "йога": 3   
}
```

### Демонстрация работы
TODO

